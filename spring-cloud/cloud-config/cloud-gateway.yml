hystrix:
  command:
    default:
      execution:
        isolation:
          thread:
            timeoutInMilliseconds: 60000 # 熔断时间, 断路器的超时时间需要大于ribbon的超时时间，不然不会触发重试, ribbon是重试机制，重试时间超过断路器的时间即中止
          strategy: SEMAPHORE   # THREAD
          semaphore:
            max-semaphores: 5000 #信号量大小
ribbon:
  ReadTimeout: 5000 # 请求处理的超时时间
  ConnectTimeout: 10000 # 请求连接的超时时间
  MaxAutoRetries: 1 #对当前实例的重试次数
  MaxAutoRetriesNextServer: 1 # 切换实例的重试次数
  OkToRetryOnAllOperations: false # 对所有操作请求都进行重试
  MaxTotalConnections: 5000   #Ribbon允许最大连接数，即所有后端微服务实例请求并发数之和的最大值。
  MaxConnectionsPerHost: 5000   #单个后端微服务实例能接收的最大请求并发数
zuul:
  host:
    connect-timeout-millis: 40000 # 连接超时时间
    socket-timeout-millis: 40000 # 超时时间
    max-total-connections: 200  #zuul内部路由可以理解为使用一个线程池去发送路由请求，所以我们也需要扩大这个线程池的容量
    max-per-route-connections: 10
  debug:
    request: false
  retryable: true
  ignoredServices: '*'
  sensitive-headers:
  custom-sensitive-headers: true
  ribbon-isolation-strategy: thread
 # semaphore:
   #   max-semaphores: 5000  # 默认值,设置默认最大信号量
  threadPool:
     useSeparateThreadPools: true
     threadPoolKeyPrefix: zuulgw
  eureka:
     cloud-service-order:
        semaphore:
           max-semaphores: 5000
  prefix:
  ratelimit:
    key-prefix: cloud-gateway
    enabled: true
    repository: REDIS
    behind-proxy: true
    default-policy: #optional - will apply unless specific policy exists
      limit: 100000 #optional - request number limit per refresh interval window
     # quota: 1 #optional - request time limit per refresh interval window (in seconds)
      refresh-interval: 60 #default value (in seconds)
      type: #optional
        - user
        - origin
        - url
  routes:
 #   cloud-service-auth:
 #     path: /auth/**
 #   cloud-service-user:
 #     path: /user/**
 #   cloud-service-sso:
 #     path: /sso/**
 #     serviceId: cloud-service-user
 #   cloud-service-pay:
 #     path: /pay/**
 #   cloud-service-profit:
 #     path: /profit/**
    cloud-service-order:
      path: /order/**
      semaphore:
        max-semaphores: 5000 #针对单个服务的路由设置最大信号量
   # cloud-service-notify:
   #   path: /notify/**


system:
  openProp:
    timeFrame: 120
  token:
    ignorePath: /**/api/**, /sso/login/**, /**/open/**, /**/share/**, /ticket/**, /payment/login/**, /**/swagger-ui.html, /**/webjars/**, /**/v2/api-docs/**, /**/swagger-resources/**